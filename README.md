# git-sweep-rs

ä¸€ä¸ªç”¨ Rust ç¼–å†™çš„ Git åˆ†æ”¯æ¸…ç†å·¥å…·ï¼Œå¸®åŠ©ä½ å¿«é€Ÿæ¸…ç†å·²åˆå¹¶çš„è¿œç¨‹å’Œæœ¬åœ°åˆ†æ”¯ã€‚

## âœ¨ ç‰¹æ€§

- ğŸš€ **é«˜æ€§èƒ½**ï¼šä½¿ç”¨ Rust ç¼–å†™ï¼Œè¿è¡Œå¿«é€Ÿ
- ğŸ” **å®‰å…¨é¢„è§ˆ**ï¼šåˆ é™¤å‰å¯ä»¥å…ˆé¢„è§ˆè¦æ¸…ç†çš„åˆ†æ”¯
- ğŸŒ **è¿œç¨‹åˆ†æ”¯æ¸…ç†**ï¼šæ¸…ç†å·²åˆå¹¶åˆ°ä¸»åˆ†æ”¯çš„è¿œç¨‹åˆ†æ”¯
- ğŸ’» **æœ¬åœ°åˆ†æ”¯æ¸…ç†**ï¼šæ¸…ç†å·²åˆå¹¶åˆ°ä¸»åˆ†æ”¯çš„æœ¬åœ°åˆ†æ”¯
- ğŸ¯ **çµæ´»é…ç½®**ï¼šæ”¯æŒè‡ªå®šä¹‰ä¸»åˆ†æ”¯åç§°ã€è·³è¿‡ç‰¹å®šåˆ†æ”¯
- âœ… **äº¤äº’ç¡®è®¤**ï¼šåˆ é™¤å‰ä¼šè¦æ±‚ç¡®è®¤ï¼ˆå¯ä½¿ç”¨ `--force` è·³è¿‡ï¼‰

## ğŸ“¦ å®‰è£…

### ä»æºç ç¼–è¯‘

ç¡®ä¿ä½ å·²ç»å®‰è£…äº† [Rust](https://www.rust-lang.org/tools/install)ï¼Œç„¶åè¿è¡Œï¼š

```bash
git clone https://github.com/leo-yi/git-sweep-rs
cd git-sweep-rs
cargo build --release
```

### å®‰è£…åˆ°ç³»ç»Ÿ

**æ–¹æ³• 1ï¼šä½¿ç”¨ cargo install**

```bash
cargo install --path .
```

**æ–¹æ³• 2ï¼šæ‰‹åŠ¨å¤åˆ¶**

```bash
sudo cp target/release/git-sweep-rs /usr/local/bin/
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### è¿œç¨‹åˆ†æ”¯æ“ä½œ

#### é¢„è§ˆè¦åˆ é™¤çš„è¿œç¨‹åˆ†æ”¯

```bash
git-sweep-rs preview --origin origin --master master
```

#### åˆ é™¤è¿œç¨‹åˆ†æ”¯

```bash
# åˆ é™¤å‰ä¼šè¦æ±‚ç¡®è®¤
git-sweep-rs cleanup --origin origin --master master

# å¼ºåˆ¶åˆ é™¤ï¼Œä¸éœ€è¦ç¡®è®¤
git-sweep-rs cleanup --force --origin origin --master master
```

### æœ¬åœ°åˆ†æ”¯æ“ä½œ

#### é¢„è§ˆè¦åˆ é™¤çš„æœ¬åœ°åˆ†æ”¯

```bash
git-sweep-rs preview-local --master master
```

#### åˆ é™¤æœ¬åœ°åˆ†æ”¯

```bash
# åˆ é™¤å‰ä¼šè¦æ±‚ç¡®è®¤
git-sweep-rs cleanup-local --master master

# å¼ºåˆ¶åˆ é™¤ï¼Œä¸éœ€è¦ç¡®è®¤
git-sweep-rs cleanup-local --force --master master
```

## ğŸ“– å‘½ä»¤è¯´æ˜

### å‘½ä»¤åˆ—è¡¨

| å‘½ä»¤ | è¯´æ˜ | æ“ä½œå¯¹è±¡ |
|------|------|---------|
| `preview` | é¢„è§ˆè¦åˆ é™¤çš„è¿œç¨‹åˆ†æ”¯ | è¿œç¨‹åˆ†æ”¯ |
| `cleanup` | åˆ é™¤å·²åˆå¹¶çš„è¿œç¨‹åˆ†æ”¯ | è¿œç¨‹åˆ†æ”¯ |
| `preview-local` | é¢„è§ˆè¦åˆ é™¤çš„æœ¬åœ°åˆ†æ”¯ | æœ¬åœ°åˆ†æ”¯ |
| `cleanup-local` | åˆ é™¤å·²åˆå¹¶çš„æœ¬åœ°åˆ†æ”¯ | æœ¬åœ°åˆ†æ”¯ |

### é€šç”¨å‚æ•°

#### preview / cleanup å‘½ä»¤

- `--origin <ORIGIN>`: æŒ‡å®šè¿œç¨‹ä»“åº“åç§°ï¼ˆé»˜è®¤ï¼š`origin`ï¼‰
- `--master <MASTER>`: æŒ‡å®šä¸»åˆ†æ”¯åç§°ï¼ˆé»˜è®¤ï¼š`master`ï¼‰
- `--nofetch`: ä¸ä»è¿œç¨‹è·å–æœ€æ–°æ•°æ®
- `--skip <BRANCHES>`: è·³è¿‡æŒ‡å®šåˆ†æ”¯ï¼Œå¤šä¸ªåˆ†æ”¯ç”¨é€—å·åˆ†éš”
- `--force`: å¼ºåˆ¶åˆ é™¤ï¼Œä¸éœ€è¦ç¡®è®¤ï¼ˆä»… cleanup å‘½ä»¤ï¼‰

#### preview-local / cleanup-local å‘½ä»¤

- `--master <MASTER>`: æŒ‡å®šä¸»åˆ†æ”¯åç§°ï¼ˆé»˜è®¤ï¼š`master`ï¼‰
- `--skip <BRANCHES>`: è·³è¿‡æŒ‡å®šåˆ†æ”¯ï¼Œå¤šä¸ªåˆ†æ”¯ç”¨é€—å·åˆ†éš”
- `--force`: å¼ºåˆ¶åˆ é™¤ï¼Œä¸éœ€è¦ç¡®è®¤ï¼ˆä»… cleanup-local å‘½ä»¤ï¼‰

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯ 1ï¼šæ¸…ç†è¿œç¨‹åˆ†æ”¯

```bash
# 1. å…ˆé¢„è§ˆå“ªäº›åˆ†æ”¯ä¼šè¢«åˆ é™¤
git-sweep-rs preview --origin origin --master main

# 2. ç¡®è®¤æ— è¯¯åæ‰§è¡Œåˆ é™¤
git-sweep-rs cleanup --origin origin --master main
```

### åœºæ™¯ 2ï¼šæ¸…ç†æœ¬åœ°åˆ†æ”¯

```bash
# 1. å…ˆé¢„è§ˆå“ªäº›æœ¬åœ°åˆ†æ”¯ä¼šè¢«åˆ é™¤
git-sweep-rs preview-local --master main

# 2. ç¡®è®¤æ— è¯¯åæ‰§è¡Œåˆ é™¤
git-sweep-rs cleanup-local --master main
```

### åœºæ™¯ 3ï¼šè·³è¿‡ç‰¹å®šåˆ†æ”¯

```bash
# è·³è¿‡ develop å’Œ staging åˆ†æ”¯
git-sweep-rs preview --master main --skip "develop,staging"
git-sweep-rs cleanup --master main --skip "develop,staging"
```

### åœºæ™¯ 4ï¼šä¸è·å–è¿œç¨‹æ›´æ–°

```bash
# ä½¿ç”¨æœ¬åœ°ç¼“å­˜çš„è¿œç¨‹åˆ†æ”¯ä¿¡æ¯
git-sweep-rs preview --nofetch
git-sweep-rs cleanup --nofetch
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **è¿œç¨‹åˆ†æ”¯åˆ é™¤æ˜¯å±é™©æ“ä½œ**
   - å»ºè®®å…ˆä½¿ç”¨ `preview` å‘½ä»¤æŸ¥çœ‹å°†è¦åˆ é™¤çš„åˆ†æ”¯
   - åˆ é™¤çš„è¿œç¨‹åˆ†æ”¯æ— æ³•ç®€å•æ¢å¤
   - å…¶ä»–å›¢é˜Ÿæˆå‘˜éœ€è¦è¿è¡Œ `git fetch --prune` æ¥åŒæ­¥

2. **æœ¬åœ°åˆ†æ”¯åˆ é™¤**
   - ä½¿ç”¨ `git branch -d` å®‰å…¨åˆ é™¤ï¼Œæœªå®Œå…¨åˆå¹¶çš„åˆ†æ”¯ä¼šæ‹’ç»åˆ é™¤
   - å¦‚æœç¡®å®éœ€è¦åˆ é™¤æœªåˆå¹¶çš„åˆ†æ”¯ï¼Œè¯·ä½¿ç”¨ `git branch -D` æ‰‹åŠ¨åˆ é™¤

3. **ä¸»åˆ†æ”¯åç§°**
   - å¾ˆå¤šé¡¹ç›®ä½¿ç”¨ `main` è€Œä¸æ˜¯ `master` ä½œä¸ºä¸»åˆ†æ”¯
   - è¯·æ ¹æ®ä½ çš„é¡¹ç›®å®é™…æƒ…å†µä½¿ç”¨ `--master main` å‚æ•°

## ğŸ”§ å·¥ä½œåŸç†

### è¿œç¨‹åˆ†æ”¯æ¸…ç†

1. ä»è¿œç¨‹ä»“åº“è·å–æœ€æ–°ä¿¡æ¯ï¼ˆé™¤éä½¿ç”¨ `--nofetch`ï¼‰
2. ä½¿ç”¨ `git for-each-ref` åˆ—å‡ºæ‰€æœ‰è¿œç¨‹åˆ†æ”¯
3. ä½¿ç”¨ `git cherry` æ£€æŸ¥æ¯ä¸ªåˆ†æ”¯æ˜¯å¦å·²å®Œå…¨åˆå¹¶åˆ°ä¸»åˆ†æ”¯
4. åˆ—å‡ºæ‰€æœ‰å·²åˆå¹¶çš„åˆ†æ”¯
5. ä½¿ç”¨ `git push origin :branch` åˆ é™¤è¿œç¨‹åˆ†æ”¯

### æœ¬åœ°åˆ†æ”¯æ¸…ç†

1. ä½¿ç”¨ `git branch --merged` åˆ—å‡ºæ‰€æœ‰å·²åˆå¹¶çš„æœ¬åœ°åˆ†æ”¯
2. æ’é™¤ä¸»åˆ†æ”¯æœ¬èº«å’Œè·³è¿‡åˆ—è¡¨ä¸­çš„åˆ†æ”¯
3. åˆ—å‡ºæ‰€æœ‰å·²åˆå¹¶çš„åˆ†æ”¯
4. ä½¿ç”¨ `git branch -d` å®‰å…¨åˆ é™¤æœ¬åœ°åˆ†æ”¯

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“ è®¸å¯è¯

MIT License

## ğŸ™ è‡´è°¢

æœ¬é¡¹ç›®å—åˆ° Python ç‰ˆæœ¬ [git-sweep](https://github.com/arc90/git-sweep) çš„å¯å‘ã€‚

## ğŸ“® åé¦ˆ

å¦‚æœä½ åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•é—®é¢˜æˆ–æœ‰æ”¹è¿›å»ºè®®ï¼Œæ¬¢è¿ï¼š

- æäº¤ [Issue](https://github.com/leo-yi/git-sweep-rs/issues)
- å‘èµ· [Pull Request](https://github.com/leo-yi/git-sweep-rs/pulls)

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ starï¼**
